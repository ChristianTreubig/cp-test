{% extends "base.html" %}

{% block content %}
    {% if request.user.id == profile_user.id %}
        This is my profile.
        <div>
            <a href="{% url 'photo_upload' %}">Upload a new photo</a>
        </div>
    {% else %}
        <div>This is the profile of {{ profile_user }}.</div>
        {% if request_user_follows_profile_user %}
            <div>You follow this profile.</div>
            <div>
                <form method="post" action="{% url 'unfollow' profile_user.id %}">
                    {% csrf_token %}
                    <input type="submit" value="Unfollow">
                </form>
            </div>
        {% else %}
            <div>You don't follow this profile.</div>
            <div>
                <form method="post" action="{% url 'follow' profile_user.id %}">
                    {% csrf_token %}
                    <input type="submit" value="Follow">
                </form>
            </div>
        {% endif %}
    {% endif %}

    <div>Following: {{ follow_counts.following }}</div>
    <div>Followers: {{ follow_counts.followers }}</div>

    {% for photo in photos %}
        <div>
            <img src="{{ photo.image.url }}" />
            {% for comment in photo.comments_with_posters.all %}
                <div>{{ comment.poster.username }} {{ comment.text }}</div>
            {% endfor %}

            <form method="post" action="{% url 'post_comment' photo.id %}">
                {% csrf_token %}
                <input type="text" name="comment">
                <input type="hidden" name="redirect_view" value="profile">
                <input type="submit" value="Comment">
            </form>
        </div>
    {% endfor %}
{% endblock content %}
